
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docker stack for getting started on IOT on the Raspberry PI">
      
      
      
      
        <link rel="prev" href="../Heimdall/">
      
      
        <link rel="next" href="../Homebridge/">
      
      
      <link rel="icon" href="../../stack-24.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>Home Assistant - IOTstack</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#home-assistant" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="IOTstack" class="md-header__button md-logo" aria-label="IOTstack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956Zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422Z"/><path d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035"/><path d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IOTstack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home Assistant
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/SensorsIot/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SensorsIot/IOTstack
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Basic_setup/" class="md-tabs__link">
          
  
  Basic setup

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../AdGuardHome/" class="md-tabs__link">
          
  
  Containers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Developers/" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Updates/" class="md-tabs__link">
          
  
  Updates

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IOTstack" class="md-nav__button md-logo" aria-label="IOTstack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956Zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422Z"/><path d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035"/><path d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035"/></svg>

    </a>
    IOTstack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SensorsIot/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SensorsIot/IOTstack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Basic setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Accessing-your-Device-from-the-internet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing your device from the internet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Backup-and-Restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backing up and restoring IOTstack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Custom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom overrides
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Default-Configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default ports
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Menu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Networking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Understanding-Containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is Docker?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/What-is-sudo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is sudo?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Containers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AdGuardHome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdGuard Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Adminer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adminer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blynk_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blynk server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chronograf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chronograf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DashMachine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DashMachine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Deconz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deCONZ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DiyHue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DIY hue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Domoticz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domoticz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Dozzle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dozzle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Duckdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Duck DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ESPHome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ESPHome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EspruinoHub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Espruinohub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Grafana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grafana
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Heimdall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heimdall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home Assistant
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home Assistant
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twoVersions" class="md-nav__link">
    <span class="md-ellipsis">
      Home Assistant: two versions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installHAContainer" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Home Assistant Container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usingBluetooth" class="md-nav__link">
    <span class="md-ellipsis">
      Using bluetooth from the container
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using bluetooth from the container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serviceDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      Possible service definition changes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpsWithSSLcert" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPS with a valid SSL certificate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hassioBackground" class="md-nav__link">
    <span class="md-ellipsis">
      about Supervised Home Assistant
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Homebridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homebridge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Homer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InfluxDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InfluxDB 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kapacitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kapacitor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MJPEG-Streamer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motion JPEG Streamer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MariaDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MariaDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mosquitto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosquitto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MotionEye/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MotionEye
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NextCloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nextcloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Node-RED/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node-RED
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Octoprint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Octoprint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OpenHab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openHAB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PgAdmin4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pgAdmin4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Pi-hole/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pi-hole
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Plex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Portainer agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-ce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Portainer CE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PostgreSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prometheus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RTL_433-docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTL_433 Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ring-MQTT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ring-MQTT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Scrypted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scrypted
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Syncthing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syncthing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TasmoAdmin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TasmoAdmin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Telegraf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telegraf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Timescaledb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timescaledb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WireGuard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WireGuard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WordPress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WordPress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../X2go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    x2go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZeroTier-vs-WireGuard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZeroTier vs WireGuard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZeroTier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZeroTier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zigbee2MQTT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zigbee2MQTT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zigbee2mqttassistant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zigbee2Mqtt Assistant
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-RandomPassword/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Stack Random Services Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Stack Services system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Git-Setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Menu-System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/PostBuild-Script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postbuild BASH Script
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Updates
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Updates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Updating the project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/Changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/New-Menu-Release-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    New IOTstack Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/gcgarner-migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrating from gcgarner to SensorsIot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/migration-network-change/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration: network change
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twoVersions" class="md-nav__link">
    <span class="md-ellipsis">
      Home Assistant: two versions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installHAContainer" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Home Assistant Container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usingBluetooth" class="md-nav__link">
    <span class="md-ellipsis">
      Using bluetooth from the container
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using bluetooth from the container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serviceDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      Possible service definition changes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpsWithSSLcert" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPS with a valid SSL certificate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hassioBackground" class="md-nav__link">
    <span class="md-ellipsis">
      about Supervised Home Assistant
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="home-assistant">Home Assistant<a class="headerlink" href="#home-assistant" title="Permanent link">&para;</a></h1>
<p>Home Assistant is a home automation platform. It is able to track and control all devices at your home and offer a platform for automating control.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><a href="https://www.home-assistant.io/">Home Assistant home page</a></p>
<ul>
<li><a href="https://www.home-assistant.io/installation/raspberrypi/">Raspberry Pi installation</a></li>
<li><a href="https://www.home-assistant.io/installation">General installation</a> (may be useful if you are trying to run on other hardware).</li>
</ul>
</li>
<li>
<p><a href="https://github.com/home-assistant/core">GitHub repository</a></p>
</li>
<li><a href="https://hub.docker.com/r/homeassistant/home-assistant/">DockerHub</a></li>
</ul>
<h2 id="twoVersions">Home Assistant: two versions<a class="headerlink" href="#twoVersions" title="Permanent link">&para;</a></h2>
<p>There are two versions of Home Assistant:</p>
<ul>
<li>Home Assistant Container; and</li>
<li>Supervised Home Assistant (also known as both "Hass.io" and "Home Assistant Core").</li>
</ul>
<p>Each version:</p>
<ul>
<li>provides a web-based management interface on port 8123; and</li>
<li>runs in "host mode" in order to discover devices on your LAN, including devices communicating via multicast traffic.</li>
</ul>
<p>Home Assistant Container runs as a <strong>single</strong> Docker container, and doesn't support all the features that Supervised Home Assistant does (such as add-ons). Supervised Home Assistant runs as a <strong>collection</strong> of Docker containers under its own orchestration.</p>
<p>The <strong>only</strong> method supported by IOTstack is Home Assistant Container.</p>
<blockquote>
<p>To understand why, see <a href="#hassioBackground">about Supervised Home Assistant</a>.</p>
</blockquote>
<p>If Home Assistant Container will not do what you want then, basically, you will need two Raspberry Pis:</p>
<ul>
<li>One running Raspberry Pi OS ("Raspbian") hosting IOTstack; and</li>
<li>Another dedicated to running <a href="https://www.home-assistant.io/installation/raspberrypi">Home Assistant Operating System</a>.</li>
</ul>
<h2 id="installHAContainer">Installing Home Assistant Container<a class="headerlink" href="#installHAContainer" title="Permanent link">&para;</a></h2>
<p>Home Assistant (Container) can be found in the <code>Build Stack</code> menu. Selecting it in this menu results in a service definition being added to:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/docker-compose.yml
</code></pre></div>
<p>The normal IOTstack commands apply to Home Assistant Container such as:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/IOTstack
<span class="gp">$ </span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<h2 id="usingBluetooth">Using bluetooth from the container<a class="headerlink" href="#usingBluetooth" title="Permanent link">&para;</a></h2>
<p>In order to be able to use BT &amp; BLE devices from HA integrations, make sure that Bluetooth is enabled:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>hciconfig
<span class="go">hci0:   Type: Primary  Bus: UART</span>
<span class="go">    BD Address: DC:89:FB:A6:32:4B  ACL MTU: 1021:8  SCO MTU: 64:1</span>
<span class="go">    UP RUNNING </span>
<span class="go">    RX bytes:2003 acl:0 sco:0 events:159 errors:0</span>
<span class="go">    TX bytes:11583 acl:0 sco:0 commands:159 errors:0</span>
</code></pre></div>
<p>The "UP" in the third line of output indicates that Bluetooth is enabled. If Bluetooth is not enabled, check:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>grep<span class="w"> </span><span class="s2">&quot;^AutoEnable&quot;</span><span class="w"> </span>/etc/bluetooth/main.conf
<span class="go">AutoEnable=true</span>
</code></pre></div>
<p>If <code>AutoEnable</code> is either missing or not set to <code>true</code>, then:</p>
<ol>
<li>
<p>Use <code>sudo</code> to and your favouring text editor to open:</p>
<div class="language-text highlight"><pre><span></span><code>/etc/bluetooth/main.conf
</code></pre></div>
</li>
<li>
<p>Find <code>AutoEnable</code> and make it <code>true</code>.</p>
<blockquote>
<p>If <code>AutoEnable</code> is missing, it needs to be added to the <code>[Policy]</code> section.</p>
</blockquote>
</li>
<li>
<p>Reboot your Raspberry Pi.</p>
</li>
<li>Check that the Bluetooth interface is enabled.</li>
</ol>
<p>See also: <a href="https://scribles.net/auto-power-on-bluetooth-adapter-on-boot-up/">Scribles: Auto Power On Bluetooth Adapter on Boot-up</a>.</p>
<h3 id="serviceDefinition">Possible service definition changes<a class="headerlink" href="#serviceDefinition" title="Permanent link">&para;</a></h3>
<p>Although the <a href="https://www.home-assistant.io/installation/raspberrypi#docker-compose">Home Assistant documentation</a> does not mention this, it is <em>possible</em> that you may also need to make the following changes to the Home Assistant service definition in your <code>docker-compose.yml</code>:</p>
<ul>
<li>
<p>Add the following mapping to the <code>volumes:</code> clause:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/dbus/system_bus_socket:/var/run/dbus/system_bus_socket</span>
</code></pre></div>
</li>
<li>
<p>Add the following <code>devices:</code> clause:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">devices</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/dev/serial1:/dev/ttyAMA0&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/dev/vcio:/dev/vcio&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/dev/gpiomem:/dev/gpiomem&quot;</span>
</code></pre></div>
</li>
</ul>
<p>Notes:</p>
<ul>
<li>These changes are <em>specific</em> to the Raspberry Pi. If you need Bluetooth support on non-Pi hardware, you will need to figure out the details for your chosen platform.</li>
<li>Historically, <code>/dev/ttyAMA0</code> meant "the serial interface" on Raspberry Pis. Subsequently, it came to mean "the Bluetooth interface" where Bluetooth support was present. Now, <code>/dev/serial1</code> is used to mean "the Raspberry Pi's Bluetooth interface". The example above maps that to the internal device <code>/dev/ttyAMA0</code> because that is <strong>probably</strong> what the container expects. There are no guarantees and you may need to experiment with internal device names.</li>
</ul>
<h2 id="httpsWithSSLcert">HTTPS with a valid SSL certificate<a class="headerlink" href="#httpsWithSSLcert" title="Permanent link">&para;</a></h2>
<p>Some HA integrations (e.g google assistant) require your HA API to be
accessible via https with a valid certificate. You can configure HA to do this:
<a href="https://www.home-assistant.io/docs/configuration/remote/">docs</a> /
<a href="https://www.home-assistant.io/docs/ecosystem/certificates/lets_encrypt/">guide</a>
or use a reverse proxy container, as described below.</p>
<p>The linuxserver Secure Web Access Gateway container
(<a href="https://docs.linuxserver.io/general/swag">swag</a>) (<a href="https://hub.docker.com/r/linuxserver/swag">Docker hub
docs</a>) will automatically generate a
SSL-certificate, update the SSL certificate before it expires and act as a
reverse proxy.</p>
<ol>
<li>First test your HA is working correctly: <code>http://raspberrypi.local:8123/</code> (assuming
your RPi hostname is raspberrypi)</li>
<li>Make sure you have duckdns working.</li>
<li>On your internet router, forward public port 443 to the RPi port 443</li>
<li>
<p>Add swag to ~/IOTstack/docker-compose.yml beneath the <code>services:</code>-line:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="w">  </span><span class="nt">swag</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/linuxserver/swag</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PUID=1000</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PGID=1000</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TZ=${TZ:-Etc/UTC}</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">URL=&lt;yourdomain&gt;.duckdns.org</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SUBDOMAINS=wildcard</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VALIDATION=duckdns</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DUCKDNSTOKEN=&lt;token&gt;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CERTPROVIDER=zerossl</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMAIL=&lt;e-mail&gt;</span><span class="w"> </span><span class="c1"># required when using zerossl</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./volumes/swag/config:/config</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443:443</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</code></pre></div>
<p>Replace the bracketed values. Do NOT use any "-characters to enclose the values.</p>
</li>
<li>
<p>Start the swag container, this creates the file to be edited in the next step:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/IOTstack
<span class="gp">$ </span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<p>Check it starts up OK: <code>docker-compose logs -f swag</code>. It will take a minute or two before it finally logs "Server ready".</p>
</li>
<li>
<p>Enable reverse proxy for <code>raspberrypi.local</code>. <code>homassistant.*</code> is already by default. and fix homeassistant container name ("upstream_app"):</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/IOTstack
<span class="gp">$ </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/server_name/server_name *.local/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>volumes/swag/config/nginx/proxy-confs/homeassistant.subdomain.conf.sample<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span>volumes/swag/config/nginx/proxy-confs/homeassistant.subdomain.conf
</code></pre></div>
</li>
<li>
<p>Forward to correct IP when target is a container running in "network_mode:
   host" (like Home Assistant does):</p>
<p><!-- Note to documentation writers: using the console-highlighter would
make the '#!/bin/sh'-line an unselectable "prompt". -->
<div class="language-bash highlight"><span class="filename">Note: in order for copy-paste to work properly, the usual $-prompts are omitted</span><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/IOTstack
cat<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39; | sudo tee volumes/swag/config/custom-cont-init.d/add-host.docker.internal.sh</span>
<span class="s">#!/bin/sh</span>
<span class="s">DOCKER_GW=$(ip route | awk &#39;NR==1 {print $3}&#39;)</span>

<span class="s">sed -i -e &quot;s/upstream_app .*/upstream_app ${DOCKER_GW};/&quot; \</span>
<span class="s">   /config/nginx/proxy-confs/homeassistant.subdomain.conf</span>
<span class="s">EOF</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>u+x<span class="w"> </span>volumes/swag/config/custom-cont-init.d/add-host.docker.internal.sh
</code></pre></div></p>
<p>(This needs to be copy-pasted/entered as-is, ignore any "&gt; "-prefixes printed
by bash)</p>
</li>
<li>
<p>(optional) Add reverse proxy password protection if you don't want to rely
   on the HA login for security, doesn't affect API-access:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/IOTstack
<span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/#auth_basic/auth_basic/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>volumes/swag/config/nginx/proxy-confs/homeassistant.subdomain.conf
<span class="gp">$ </span>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>swag<span class="w"> </span>htpasswd<span class="w"> </span>-c<span class="w"> </span>/config/nginx/.htpasswd<span class="w"> </span>anyusername
</code></pre></div>
</li>
<li>
<p>Add <code>use_x_forwarded_for</code> and <code>trusted_proxies</code> to your homeassistant <a href="https://www.home-assistant.io/integrations/http">http
   config</a>. The configuration
   file is at <code>volumes/home_assistant/configuration.yaml</code> For a default install
   the resulting http-section should be:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">   </span><span class="nt">use_x_forwarded_for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">trusted_proxies</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0/16</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0/12</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.77.0.0/16</span>
</code></pre></div>
</li>
<li>
<p>Refresh the stack: <code>cd ~/IOTstack &amp;&amp; docker-compose stop &amp;&amp; docker-compose
    up -d</code> (again may take 1-3 minutes for swag to start if it recreates
    certificates)</p>
</li>
<li>Test homeassistant is still working correctly:
    <code>http://raspberrypi.local:8123/</code> (assuming your RPi hostname is
    raspberrypi)</li>
<li>
<p>Test the reverse proxy https is working correctly:
    <code>https://raspberrypi.local/</code> (browser will issue a warning about wrong
    certificate domain, as the certificate is issued for you duckdns-domain, we
    are just testing)</p>
<p>Or from the command line in the RPi:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>curl<span class="w"> </span>--resolve<span class="w"> </span>homeassistant.&lt;yourdomain&gt;.duckdns.org:443:127.0.0.1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>https://homeassistant.&lt;yourdomain&gt;.duckdns.org/
</code></pre></div>
<p>(output should end in <code>if (!window.latestJS) { }&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code>)</p>
</li>
<li>
<p>And finally test your router forwards correctly by accessing it from
    outside your LAN(e.g. using a mobile phone):
    <code>https://homeassistant.&lt;yourdomain&gt;.duckdns.org/</code> Now the certificate
    should work without any warnings.</p>
</li>
</ol>
<h2 id="hassioBackground">about Supervised Home Assistant<a class="headerlink" href="#hassioBackground" title="Permanent link">&para;</a></h2>
<p>IOTstack used to offer a menu entry leading to a convenience script that could install Supervised Home Assistant. That script stopped working when Home Assistant changed their approach. The script's author <a href="https://github.com/Kanga-Who/home-assistant/blob/master/Supervised%20on%20Raspberry%20Pi%20with%20Debian.md">made it clear</a> that script's future was bleak so the affordance was <a href="https://github.com/SensorsIot/IOTstack/pull/493">removed from IOTstack</a>.</p>
<p>For a time, you could manually install Supervised Home Assistant using their <a href="https://github.com/home-assistant/supervised-installer">installation instructions for advanced users</a>. Once you got HA working, you could install IOTstack, and the two would (mostly) happily coexist.</p>
<p>The direction being taken by the Home Assistant folks is to supply a <a href="https://www.home-assistant.io/installation/raspberrypi">ready-to-run image for your Raspberry Pi</a>. They still support the installation instructions for advanced users but the <a href="https://github.com/home-assistant/architecture/blob/master/adr/0014-home-assistant-supervised.md#supported-operating-system-system-dependencies-and-versions">requirements</a> are very specific. In particular:</p>
<blockquote>
<p>Debian Linux Debian 11 aka Bullseye (no derivatives)</p>
</blockquote>
<p>Raspberry Pi OS is a Debian <em>derivative</em> and it is becoming increasingly clear that the "no derivatives" part of that requirement must be taken literally and seriously. Recent examples of significant incompatibilities include:</p>
<ul>
<li><a href="https://github.com/home-assistant/supervised-installer/pull/201">introducing a dependency on <code>grub</code> (GRand Unified Bootloader)</a>. The Raspberry Pi does not use <code>grub</code> but the change is actually about forcing Control Groups version 1 when the Raspberry Pi uses version 2.</li>
<li><a href="https://github.com/home-assistant/supervised-installer/pull/202">unilaterally starting <code>systemd-resolved</code></a>. This is a DNS resolver which claims port 53. That means you can't run your own DNS service like PiHole, AdGuardHome or BIND9 as an IOTstack container. </li>
</ul>
<p>Because of the self-updating nature of Supervised Home Assistant, your Raspberry Pi might be happily running Supervised Home Assistant plus IOTstack one day, and suddenly start misbehaving the next day, simply because Supervised Home Assistant assumed it was in total control of your Raspberry Pi.</p>
<p>If you want Supervised Home Assistant to work, reliably, it really needs to be its own dedicated appliance. If you want IOTstack to work, reliably, it really needs to be kept well away from Supervised Home Assistant. If you want both Supervised Home Assistant and IOTstack, you really need two Raspberry Pis.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "tabs", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascript/fix-codeblock-console-copy-button.js"></script>
      
    
  </body>
</html>